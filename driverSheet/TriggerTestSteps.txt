package javaSeed.driverSheet;

import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

import javaSeed.constants.Const;

public class TriggerTestSteps{
	
	// Declare Test Step Array for each Scenario
	private static String[] ArrListScenariosTestSteps;
	// Declare Test Data Array for each Scenario
	private static String[] arrTestCaseData;
	// Getter for Test Step Array for each Scenario
	public static String[] getArrListScenariosTestSteps() {
		return ArrListScenariosTestSteps;
	}
	// Setter for Test Step Array for each Scenario
	public static void setArrListScenariosTestSteps(String[] arrListScenariosTestSteps) {
		ArrListScenariosTestSteps = arrListScenariosTestSteps;
	}
	// Getter for Test Data Array for each Scenario
	public static String[] getArrTestCaseData() {
		return arrTestCaseData;
	}
	// Setter for Test Data Array for each Scenario
	public static void setArrTestCaseData(String[] arrTestCaseDataPassed) {
		arrTestCaseData = arrTestCaseDataPassed;
	}
	// Local Variable that will have Constant Class Path already declared
	private static String LocPAKG_GPS_PATH = Const.PAKG_GPS_PATH;		//?????????????????????? HARDCODED

	public static void TestStepsSingleExecution(){
		
		String[] TestStepRow = ArrListScenariosTestSteps;
		String[] TestDataRow = arrTestCaseData;
		
		try {
			
			// Declare Class of Application Test Scripts Class (Passed as Parameter, which was picked up from the TestSteps Sheet) to get all Methods defined in that 
			Class<?> clazz = Class.forName(LocPAKG_GPS_PATH+TestStepRow[2]); 
			Constructor<?> ctor = clazz.getConstructor();
			Object GPSTestPack = ctor.newInstance(new Object[]{});
			
			//GPSTestScripts GPSTestPack = new GPSTestScripts();
					Class<?> GPSFunctionList = GPSTestPack.getClass();
					Method[] AllMethods =  GPSFunctionList.getMethods();
	 
						for (Method method:AllMethods){
						
								// Compare Each Method Name with what defined in the TestStep Sheet. If Condition true Call that Function from Application Test Scripts Class
						if (TestStepRow[3].toString().contentEquals(method.getName().toString())){
							
							switch (TestStepRow.length){
								case 4:
									try {
										method.invoke(GPSTestPack);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 5:
									try { // Need to Add TestStepRow[4]. "toUpperCase()" ).charAt(0))-65]
										method.invoke(GPSTestPack, TestDataRow[4]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 6:
									try {
										method.invoke(GPSTestPack, TestDataRow[4], TestDataRow[5]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 7:
									try {
										method.invoke(GPSTestPack, TestDataRow[4],TestDataRow[5],TestDataRow[6]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 8:
									try {
										method.invoke(GPSTestPack, TestDataRow[4],TestDataRow[5],TestDataRow[6],TestDataRow[7]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 9:
									try {
										method.invoke(GPSTestPack, TestDataRow[4],TestDataRow[5],TestDataRow[6],TestDataRow[7],TestDataRow[8]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 10:
									try {
										method.invoke(GPSTestPack, TestDataRow[4],TestDataRow[5],TestDataRow[6],TestDataRow[7],TestDataRow[8],TestDataRow[9]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 11:
									try {
										method.invoke(GPSTestPack, TestDataRow[4],TestDataRow[5],TestDataRow[6],TestDataRow[7],TestDataRow[8],TestDataRow[9],TestDataRow[10]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 12:
									try {
										method.invoke(GPSTestPack, TestDataRow[4],TestDataRow[5],TestDataRow[6],TestDataRow[7],TestDataRow[8],TestDataRow[9],TestDataRow[10],TestDataRow[11]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 13:
									try {
										method.invoke(GPSTestPack, TestDataRow[4],TestDataRow[5],TestDataRow[6],TestDataRow[7],TestDataRow[8],TestDataRow[9],TestDataRow[10],TestDataRow[11],TestDataRow[12]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 14:
									try {
										method.invoke(GPSTestPack, TestDataRow[4],TestDataRow[5],TestDataRow[6],TestDataRow[7],TestDataRow[8],TestDataRow[9],TestDataRow[10],TestDataRow[11],TestDataRow[12],TestDataRow[13]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
							
							}
	
						}
					}

				
			}
						
			catch (Exception e){
				e.printStackTrace();
			
		}				
		
	}
	
	public static void TestStepsIterationExecution () throws ClassNotFoundException, NoSuchMethodException, SecurityException, InstantiationException, IllegalAccessException, IllegalArgumentException, InvocationTargetException{
			
		String[] TestStepRow = ArrListScenariosTestSteps;
		String[] TestDataRow = arrTestCaseData;
		
			try {
				
			// Declare Class of Application Test Scripts Class (Passed as Parameter, which was picked up from the TestSteps Sheet) to get all Methods defined in that 
			Class<?> clazz = Class.forName(LocPAKG_GPS_PATH+TestStepRow[2]); 
			Constructor<?> ctor = clazz.getConstructor();
			Object GPSTestPack = ctor.newInstance(new Object[]{});
			
			//GPSTestScripts GPSTestPack = new GPSTestScripts();
					Class<?> GPSFunctionList = GPSTestPack.getClass();
					Method[] AllMethods =  GPSFunctionList.getMethods();
	 
						for (Method method:AllMethods){
						
								// Compare Each Method Name with what defined in the TestStep Sheet. If Condition true Call that Function from Application Test Scripts Class
						if (TestStepRow[3].toString().contentEquals(method.getName().toString())){
							
							switch (TestStepRow.length){
								case 4:
									try {
										method.invoke(GPSTestPack);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 5:
									try { // Need to Add TestStepRow[4]. "toUpperCase()" ).charAt(0))-65]
										method.invoke(GPSTestPack, TestDataRow[(int)(TestStepRow[4].toUpperCase().charAt(0))-65]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 6:
									try {
										method.invoke(GPSTestPack, TestDataRow[(int)(TestStepRow[4].toUpperCase().charAt(0))-65], TestDataRow[(int)(TestStepRow[5].toUpperCase().charAt(0))-65]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 7:
									try {
										method.invoke(GPSTestPack, TestDataRow[(int)(TestStepRow[4].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[5].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[6].toUpperCase().charAt(0))-65]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 8:
									try {
										method.invoke(GPSTestPack, TestDataRow[(int)(TestStepRow[4].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[5].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[6].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[7].toUpperCase().charAt(0))-65]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 9:
									try {
										method.invoke(GPSTestPack, TestDataRow[(int)(TestStepRow[4].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[5].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[6].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[7].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[8].toUpperCase().charAt(0))-65]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 10:
									try {
										method.invoke(GPSTestPack, TestDataRow[(int)(TestStepRow[4].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[5].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[6].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[7].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[8].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[9].toUpperCase().charAt(0))-65]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 11:
									try {
										method.invoke(GPSTestPack, TestDataRow[(int)(TestStepRow[4].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[5].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[6].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[7].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[8].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[9].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[10].toUpperCase().charAt(0))-65]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 12:
									try {
										method.invoke(GPSTestPack, TestDataRow[(int)(TestStepRow[4].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[5].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[6].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[7].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[8].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[9].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[10].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[11].toUpperCase().charAt(0))-65]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 13:
									try {
										method.invoke(GPSTestPack, TestDataRow[(int)(TestStepRow[4].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[5].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[6].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[7].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[8].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[9].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[10].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[11].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[12].toUpperCase().charAt(0))-65]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
								case 14:
									try {
										method.invoke(GPSTestPack, TestDataRow[(int)(TestStepRow[4].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[5].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[6].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[7].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[8].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[9].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[10].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[11].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[12].toUpperCase().charAt(0))-65],TestDataRow[(int)(TestStepRow[13].toUpperCase().charAt(0))-65]);
									} catch (IllegalAccessException e){
										e.printStackTrace();
									} 
								break;
							
							}
	
						}
					}

				
			}
						
			catch (Exception e){
				e.printStackTrace();
			
		}					
	}
}
